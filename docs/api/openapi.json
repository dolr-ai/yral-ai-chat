{
  "openapi": "3.1.0",
  "info": {
    "title": "Yral AI Chat API",
    "description": "AI Chat API for Yral with multimodal support",
    "version": "1.0.0"
  },
  "paths": {
    "/health": {
      "get": {
        "tags": [
          "Health"
        ],
        "summary": "Health check",
        "description": "Check the health status of all services including database, AI, and storage",
        "operationId": "healthCheck",
        "responses": {
          "200": {
            "description": "Health check completed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/status": {
      "get": {
        "tags": [
          "Health"
        ],
        "summary": "System status",
        "description": "Get detailed system statistics including database info, uptime, and usage metrics",
        "operationId": "systemStatus",
        "responses": {
          "200": {
            "description": "System status retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StatusResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/api/v1/influencers": {
      "get": {
        "tags": [
          "Influencers"
        ],
        "summary": "List AI influencers",
        "description": "Retrieve paginated list of available AI influencers. No authentication required.",
        "operationId": "listInfluencers",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "description": "Number of influencers to return",
              "default": 50,
              "title": "Limit"
            },
            "description": "Number of influencers to return"
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of influencers to skip",
              "default": 0,
              "title": "Offset"
            },
            "description": "Number of influencers to skip"
          }
        ],
        "responses": {
          "200": {
            "description": "List of influencers retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListInfluencersResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation error - Invalid query parameters"
          },
          "429": {
            "description": "Rate limit exceeded"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/api/v1/influencers/{influencer_id}": {
      "get": {
        "tags": [
          "Influencers"
        ],
        "summary": "Get influencer details",
        "description": "Retrieve detailed information about a specific AI influencer. No authentication required.",
        "operationId": "getInfluencer",
        "parameters": [
          {
            "name": "influencer_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "title": "Influencer Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Influencer details retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InfluencerResponse"
                }
              }
            }
          },
          "404": {
            "description": "Influencer not found"
          },
          "422": {
            "description": "Validation error - Invalid influencer ID format"
          },
          "429": {
            "description": "Rate limit exceeded"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/api/v1/chat/conversations": {
      "post": {
        "tags": [
          "Chat"
        ],
        "summary": "Create a new conversation",
        "description": "Create a new conversation with an AI influencer.\n    \n    If a conversation already exists between the user and influencer, \n    returns the existing conversation instead of creating a new one.\n    \n    **Authentication required**: JWT token in Authorization header",
        "operationId": "createConversation",
        "parameters": [
          {
            "name": "authorization",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Authorization"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateConversationRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Conversation created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConversationResponse"
                },
                "example": {
                  "id": "550e8400-e29b-41d4-a716-446655440000",
                  "user_id": "user123",
                  "influencer": {
                    "id": "660e8400-e29b-41d4-a716-446655440000",
                    "name": "tech_guru",
                    "display_name": "Tech Guru AI",
                    "avatar_url": "https://example.com/avatar.jpg"
                  },
                  "created_at": "2024-01-15T10:30:00Z",
                  "updated_at": "2024-01-15T10:30:00Z",
                  "message_count": 0
                }
              }
            }
          },
          "400": {
            "description": "Bad request - Invalid influencer_id format"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing JWT token"
          },
          "404": {
            "description": "Influencer not found"
          },
          "422": {
            "description": "Validation error - Request body validation failed"
          },
          "429": {
            "description": "Rate limit exceeded"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      },
      "get": {
        "tags": [
          "Chat"
        ],
        "summary": "List user conversations",
        "description": "Retrieve paginated list of user's conversations, optionally filtered by influencer",
        "operationId": "listConversations",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "description": "Number of conversations to return",
              "default": 20,
              "title": "Limit"
            },
            "description": "Number of conversations to return"
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of conversations to skip",
              "default": 0,
              "title": "Offset"
            },
            "description": "Number of conversations to skip"
          },
          {
            "name": "influencer_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string",
                  "format": "uuid"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Filter by specific influencer ID",
              "title": "Influencer Id"
            },
            "description": "Filter by specific influencer ID"
          },
          {
            "name": "authorization",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Authorization"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of conversations retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListConversationsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing JWT token"
          },
          "422": {
            "description": "Validation error - Invalid query parameters"
          },
          "429": {
            "description": "Rate limit exceeded"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/api/v1/chat/conversations/{conversation_id}/messages": {
      "get": {
        "tags": [
          "Chat"
        ],
        "summary": "Get conversation messages",
        "description": "Retrieve paginated message history for a conversation",
        "operationId": "listMessages",
        "parameters": [
          {
            "name": "conversation_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "title": "Conversation Id"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 200,
              "minimum": 1,
              "description": "Number of messages to return",
              "default": 50,
              "title": "Limit"
            },
            "description": "Number of messages to return"
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of messages to skip",
              "default": 0,
              "title": "Offset"
            },
            "description": "Number of messages to skip"
          },
          {
            "name": "order",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "pattern": "^(asc|desc)$",
              "description": "Sort order: 'asc' or 'desc'",
              "default": "desc",
              "title": "Order"
            },
            "description": "Sort order: 'asc' or 'desc'"
          },
          {
            "name": "authorization",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Authorization"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Messages retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListMessagesResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing JWT token"
          },
          "403": {
            "description": "Forbidden - Not authorized to access this conversation"
          },
          "404": {
            "description": "Conversation not found"
          },
          "422": {
            "description": "Validation error - Invalid parameters"
          },
          "429": {
            "description": "Rate limit exceeded"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      },
      "post": {
        "tags": [
          "Chat"
        ],
        "summary": "Send a message",
        "description": "Send a message to an AI influencer and receive a response.\n    \n    Supports multiple message types:\n    - **TEXT**: Plain text messages\n    - **IMAGE**: Image-only messages  \n    - **MULTIMODAL**: Text with images\n    - **AUDIO**: Voice/audio messages\n    \n    The AI response is returned immediately. Background tasks handle logging and cache updates.",
        "operationId": "sendMessage",
        "parameters": [
          {
            "name": "conversation_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "title": "Conversation Id"
            }
          },
          {
            "name": "authorization",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Authorization"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SendMessageRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Message sent and AI response received successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SendMessageResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad request - Invalid message format or content"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing JWT token"
          },
          "403": {
            "description": "Forbidden - Not authorized to access this conversation"
          },
          "404": {
            "description": "Conversation not found"
          },
          "422": {
            "description": "Validation error - Invalid message data"
          },
          "429": {
            "description": "Rate limit exceeded"
          },
          "500": {
            "description": "Internal server error"
          },
          "503": {
            "description": "Service unavailable - AI service temporarily unavailable"
          }
        }
      }
    },
    "/api/v1/chat/conversations/{conversation_id}": {
      "delete": {
        "tags": [
          "Chat"
        ],
        "summary": "Delete a conversation",
        "description": "Permanently delete a conversation and all its associated messages",
        "operationId": "deleteConversation",
        "parameters": [
          {
            "name": "conversation_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "title": "Conversation Id"
            }
          },
          {
            "name": "authorization",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Authorization"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Conversation deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeleteConversationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing JWT token"
          },
          "403": {
            "description": "Forbidden - Not authorized to delete this conversation"
          },
          "404": {
            "description": "Conversation not found"
          },
          "429": {
            "description": "Rate limit exceeded"
          },
          "500": {
            "description": "Internal server error"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/media/upload": {
      "post": {
        "tags": [
          "Media"
        ],
        "summary": "Upload media file",
        "description": "Upload an image or audio file to cloud storage.\n    \n    **Supported formats:**\n    - Images: JPEG, PNG, GIF, WebP (max 10MB)\n    - Audio: MP3, WAV, M4A (max 20MB, 5 minutes)\n    \n    Returns the public URL of the uploaded file.\n    \n    **Authentication required**: JWT token in Authorization header",
        "operationId": "uploadMedia",
        "parameters": [
          {
            "name": "authorization",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Authorization"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "$ref": "#/components/schemas/Body_uploadMedia"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "File uploaded successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MediaUploadResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad request - Invalid file type or size"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing JWT token"
          },
          "413": {
            "description": "Payload too large - File exceeds size limit"
          },
          "422": {
            "description": "Validation error - Invalid form data"
          },
          "429": {
            "description": "Rate limit exceeded"
          },
          "500": {
            "description": "Internal server error - Upload failed"
          },
          "503": {
            "description": "Service unavailable - Storage service unavailable"
          }
        }
      }
    },
    "/metrics": {
      "get": {
        "tags": [
          "Monitoring"
        ],
        "summary": "Get Metrics",
        "description": "Prometheus metrics endpoint",
        "operationId": "get_metrics_metrics_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/": {
      "get": {
        "tags": [
          "Root"
        ],
        "summary": "Root",
        "description": "Root endpoint",
        "operationId": "root__get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "Body_uploadMedia": {
        "properties": {
          "file": {
            "type": "string",
            "format": "binary",
            "title": "File",
            "description": "File to upload"
          },
          "type": {
            "type": "string",
            "pattern": "^(image|audio)$",
            "title": "Type",
            "description": "Type of media: 'image' or 'audio'"
          }
        },
        "type": "object",
        "required": [
          "file",
          "type"
        ],
        "title": "Body_uploadMedia"
      },
      "ConversationResponse": {
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "title": "Id"
          },
          "user_id": {
            "type": "string",
            "title": "User Id"
          },
          "influencer": {
            "$ref": "#/components/schemas/InfluencerBasicInfo"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "title": "Updated At"
          },
          "message_count": {
            "type": "integer",
            "title": "Message Count",
            "default": 0
          },
          "last_message": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/LastMessageInfo"
              },
              {
                "type": "null"
              }
            ]
          }
        },
        "type": "object",
        "required": [
          "id",
          "user_id",
          "influencer",
          "created_at",
          "updated_at"
        ],
        "title": "ConversationResponse",
        "description": "Conversation response model"
      },
      "CreateConversationRequest": {
        "properties": {
          "influencer_id": {
            "type": "string",
            "format": "uuid",
            "title": "Influencer Id",
            "description": "ID of the AI influencer",
            "examples": [
              "550e8400-e29b-41d4-a716-446655440000"
            ]
          }
        },
        "type": "object",
        "required": [
          "influencer_id"
        ],
        "title": "CreateConversationRequest",
        "description": "Request to create a new conversation",
        "examples": [
          {
            "influencer_id": "550e8400-e29b-41d4-a716-446655440000"
          }
        ]
      },
      "DatabaseStats": {
        "properties": {
          "connected": {
            "type": "boolean",
            "title": "Connected"
          },
          "pool_size": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Pool Size"
          },
          "active_connections": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Active Connections"
          }
        },
        "type": "object",
        "required": [
          "connected"
        ],
        "title": "DatabaseStats",
        "description": "Database statistics"
      },
      "DeleteConversationResponse": {
        "properties": {
          "success": {
            "type": "boolean",
            "title": "Success"
          },
          "message": {
            "type": "string",
            "title": "Message"
          },
          "deleted_conversation_id": {
            "type": "string",
            "format": "uuid",
            "title": "Deleted Conversation Id"
          },
          "deleted_messages_count": {
            "type": "integer",
            "title": "Deleted Messages Count"
          }
        },
        "type": "object",
        "required": [
          "success",
          "message",
          "deleted_conversation_id",
          "deleted_messages_count"
        ],
        "title": "DeleteConversationResponse",
        "description": "Delete conversation response"
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "HealthResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "title": "Timestamp"
          },
          "services": {
            "additionalProperties": {
              "$ref": "#/components/schemas/ServiceHealth"
            },
            "type": "object",
            "title": "Services"
          }
        },
        "type": "object",
        "required": [
          "status",
          "timestamp",
          "services"
        ],
        "title": "HealthResponse",
        "description": "Health check response"
      },
      "InfluencerBasicInfo": {
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "title": "Id",
            "description": "Unique identifier for the influencer",
            "examples": [
              "550e8400-e29b-41d4-a716-446655440000"
            ]
          },
          "name": {
            "type": "string",
            "title": "Name",
            "description": "URL-friendly username",
            "examples": [
              "tech_guru_ai"
            ]
          },
          "display_name": {
            "type": "string",
            "title": "Display Name",
            "description": "Display name for the influencer",
            "examples": [
              "Tech Guru AI"
            ]
          },
          "avatar_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Avatar Url",
            "description": "Profile picture URL",
            "examples": [
              "https://cdn.yral.com/avatars/tech_guru.png"
            ]
          }
        },
        "type": "object",
        "required": [
          "id",
          "name",
          "display_name"
        ],
        "title": "InfluencerBasicInfo",
        "description": "Basic influencer information"
      },
      "InfluencerResponse": {
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "title": "Id",
            "description": "Unique identifier for the influencer"
          },
          "name": {
            "type": "string",
            "title": "Name",
            "description": "URL-friendly username",
            "examples": [
              "tech_guru_ai"
            ]
          },
          "display_name": {
            "type": "string",
            "title": "Display Name",
            "description": "Display name",
            "examples": [
              "Tech Guru AI"
            ]
          },
          "avatar_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Avatar Url",
            "description": "Profile picture URL"
          },
          "description": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Description",
            "description": "Bio/description of the influencer"
          },
          "category": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Category",
            "description": "Category/expertise area",
            "examples": [
              "Technology"
            ]
          },
          "is_active": {
            "type": "boolean",
            "title": "Is Active",
            "description": "Whether influencer is currently active"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At",
            "description": "Creation timestamp"
          },
          "conversation_count": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Conversation Count",
            "description": "Total conversations with this influencer"
          }
        },
        "type": "object",
        "required": [
          "id",
          "name",
          "display_name",
          "is_active",
          "created_at"
        ],
        "title": "InfluencerResponse",
        "description": "AI Influencer response model"
      },
      "LastMessageInfo": {
        "properties": {
          "content": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Content"
          },
          "role": {
            "$ref": "#/components/schemas/MessageRole"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          }
        },
        "type": "object",
        "required": [
          "role",
          "created_at"
        ],
        "title": "LastMessageInfo",
        "description": "Last message information for conversation list"
      },
      "ListConversationsResponse": {
        "properties": {
          "conversations": {
            "items": {
              "$ref": "#/components/schemas/ConversationResponse"
            },
            "type": "array",
            "title": "Conversations"
          },
          "total": {
            "type": "integer",
            "title": "Total"
          },
          "limit": {
            "type": "integer",
            "title": "Limit"
          },
          "offset": {
            "type": "integer",
            "title": "Offset"
          }
        },
        "type": "object",
        "required": [
          "conversations",
          "total",
          "limit",
          "offset"
        ],
        "title": "ListConversationsResponse",
        "description": "Response for listing conversations"
      },
      "ListInfluencersResponse": {
        "properties": {
          "influencers": {
            "items": {
              "$ref": "#/components/schemas/InfluencerResponse"
            },
            "type": "array",
            "title": "Influencers"
          },
          "total": {
            "type": "integer",
            "title": "Total"
          },
          "limit": {
            "type": "integer",
            "title": "Limit"
          },
          "offset": {
            "type": "integer",
            "title": "Offset"
          }
        },
        "type": "object",
        "required": [
          "influencers",
          "total",
          "limit",
          "offset"
        ],
        "title": "ListInfluencersResponse",
        "description": "Response for listing influencers"
      },
      "ListMessagesResponse": {
        "properties": {
          "conversation_id": {
            "type": "string",
            "format": "uuid",
            "title": "Conversation Id"
          },
          "messages": {
            "items": {
              "$ref": "#/components/schemas/MessageResponse"
            },
            "type": "array",
            "title": "Messages"
          },
          "total": {
            "type": "integer",
            "title": "Total"
          },
          "limit": {
            "type": "integer",
            "title": "Limit"
          },
          "offset": {
            "type": "integer",
            "title": "Offset"
          }
        },
        "type": "object",
        "required": [
          "conversation_id",
          "messages",
          "total",
          "limit",
          "offset"
        ],
        "title": "ListMessagesResponse",
        "description": "Response for listing messages"
      },
      "MediaUploadResponse": {
        "properties": {
          "url": {
            "type": "string",
            "title": "Url",
            "description": "Public URL of uploaded file",
            "examples": [
              "https://storage.example.com/uploads/image123.jpg"
            ]
          },
          "type": {
            "type": "string",
            "title": "Type",
            "description": "Media type: 'image' or 'audio'",
            "examples": [
              "image"
            ]
          },
          "size": {
            "type": "integer",
            "title": "Size",
            "description": "File size in bytes",
            "examples": [
              1024000
            ]
          },
          "mime_type": {
            "type": "string",
            "title": "Mime Type",
            "description": "MIME type of the file",
            "examples": [
              "image/jpeg"
            ]
          },
          "duration_seconds": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Duration Seconds",
            "description": "Audio duration in seconds (audio only)",
            "examples": [
              null
            ]
          },
          "uploaded_at": {
            "type": "string",
            "format": "date-time",
            "title": "Uploaded At",
            "description": "Upload timestamp"
          }
        },
        "type": "object",
        "required": [
          "url",
          "type",
          "size",
          "mime_type",
          "uploaded_at"
        ],
        "title": "MediaUploadResponse",
        "description": "Media upload response"
      },
      "MessageResponse": {
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "title": "Id",
            "description": "Unique message identifier"
          },
          "role": {
            "allOf": [
              {
                "$ref": "#/components/schemas/MessageRole"
              }
            ],
            "description": "Message sender: 'user' or 'assistant'",
            "examples": [
              "user"
            ]
          },
          "content": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Content",
            "description": "Message text content",
            "examples": [
              "Hello! How are you today?"
            ]
          },
          "message_type": {
            "allOf": [
              {
                "$ref": "#/components/schemas/MessageType"
              }
            ],
            "description": "Message type: TEXT, IMAGE, MULTIMODAL, or AUDIO",
            "examples": [
              "TEXT"
            ]
          },
          "media_urls": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Media Urls",
            "description": "Array of image URLs",
            "examples": [
              []
            ]
          },
          "audio_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Audio Url",
            "description": "URL to audio file",
            "examples": [
              null
            ]
          },
          "audio_duration_seconds": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Audio Duration Seconds",
            "description": "Audio duration in seconds",
            "examples": [
              null
            ]
          },
          "token_count": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Token Count",
            "description": "AI tokens used (assistant messages only)",
            "examples": [
              150
            ]
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At",
            "description": "Message timestamp"
          }
        },
        "type": "object",
        "required": [
          "id",
          "role",
          "message_type",
          "created_at"
        ],
        "title": "MessageResponse",
        "description": "Message response model"
      },
      "MessageRole": {
        "type": "string",
        "enum": [
          "user",
          "assistant"
        ],
        "title": "MessageRole",
        "description": "Message role enumeration"
      },
      "MessageType": {
        "type": "string",
        "enum": [
          "text",
          "multimodal",
          "image",
          "audio"
        ],
        "title": "MessageType",
        "description": "Message type enumeration"
      },
      "SendMessageRequest": {
        "properties": {
          "message_type": {
            "allOf": [
              {
                "$ref": "#/components/schemas/MessageType"
              }
            ],
            "description": "Type of message: TEXT, IMAGE, MULTIMODAL, or AUDIO",
            "examples": [
              "TEXT"
            ]
          },
          "content": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 4000
              },
              {
                "type": "null"
              }
            ],
            "title": "Content",
            "description": "Message text content (optional for image/audio-only messages)",
            "default": "",
            "examples": [
              "Hello! How are you today?"
            ]
          },
          "media_urls": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array",
                "maxItems": 10
              },
              {
                "type": "null"
              }
            ],
            "title": "Media Urls",
            "description": "Array of image URLs (max 10)",
            "examples": [
              [
                "https://example.com/image.jpg"
              ]
            ]
          },
          "audio_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Audio Url",
            "description": "URL to audio file",
            "examples": [
              "https://example.com/audio.mp3"
            ]
          },
          "audio_duration_seconds": {
            "anyOf": [
              {
                "type": "integer",
                "maximum": 300.0,
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Audio Duration Seconds",
            "description": "Audio duration in seconds (max 300)",
            "examples": [
              45
            ]
          }
        },
        "type": "object",
        "required": [
          "message_type"
        ],
        "title": "SendMessageRequest",
        "description": "Request to send a message in a conversation",
        "examples": [
          {
            "content": "Hello! How are you today?",
            "message_type": "TEXT"
          },
          {
            "content": "What's in this image?",
            "media_urls": [
              "https://example.com/image.jpg"
            ],
            "message_type": "IMAGE"
          },
          {
            "audio_duration_seconds": 45,
            "audio_url": "https://example.com/audio.mp3",
            "content": "",
            "message_type": "AUDIO"
          }
        ]
      },
      "SendMessageResponse": {
        "properties": {
          "user_message": {
            "$ref": "#/components/schemas/MessageResponse"
          },
          "assistant_message": {
            "$ref": "#/components/schemas/MessageResponse"
          }
        },
        "type": "object",
        "required": [
          "user_message",
          "assistant_message"
        ],
        "title": "SendMessageResponse",
        "description": "Response when sending a message"
      },
      "ServiceHealth": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status"
          },
          "latency_ms": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Latency Ms"
          },
          "error": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Error"
          },
          "pool_size": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Pool Size"
          },
          "pool_free": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Pool Free"
          }
        },
        "type": "object",
        "required": [
          "status"
        ],
        "title": "ServiceHealth",
        "description": "Health status of a service"
      },
      "StatusResponse": {
        "properties": {
          "service": {
            "type": "string",
            "title": "Service"
          },
          "version": {
            "type": "string",
            "title": "Version"
          },
          "environment": {
            "type": "string",
            "title": "Environment"
          },
          "uptime_seconds": {
            "type": "integer",
            "title": "Uptime Seconds"
          },
          "database": {
            "$ref": "#/components/schemas/DatabaseStats"
          },
          "statistics": {
            "$ref": "#/components/schemas/SystemStatistics"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "title": "Timestamp"
          }
        },
        "type": "object",
        "required": [
          "service",
          "version",
          "environment",
          "uptime_seconds",
          "database",
          "statistics",
          "timestamp"
        ],
        "title": "StatusResponse",
        "description": "System status response"
      },
      "SystemStatistics": {
        "properties": {
          "total_conversations": {
            "type": "integer",
            "title": "Total Conversations",
            "default": 0
          },
          "total_messages": {
            "type": "integer",
            "title": "Total Messages",
            "default": 0
          },
          "active_influencers": {
            "type": "integer",
            "title": "Active Influencers",
            "default": 0
          }
        },
        "type": "object",
        "title": "SystemStatistics",
        "description": "System-wide statistics"
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          }
        },
        "type": "object",
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError"
      }
    },
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "Enter your JWT token (without 'Bearer' prefix)"
      }
    }
  }
}