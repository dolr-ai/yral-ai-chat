# Yral AI Chat API - Environment Configuration
# Copy this file to .env and fill in the values

# ===========================================
# Application Settings
# ===========================================
APP_NAME=Yral AI Chat API
APP_VERSION=1.0.0
ENVIRONMENT=production
DEBUG=False
HOST=0.0.0.0
PORT=8000

# ===========================================
# Database (SQLite with Litestream)
# ===========================================
DATABASE_PATH=/root/yral-ai-chat/data/yral_chat.db
# Increased pool size for high traffic (default: 10, max: 20)
# SQLite with WAL mode handles concurrent reads well
DATABASE_POOL_SIZE=10
DATABASE_POOL_TIMEOUT=30.0

# ===========================================
# JWT Authentication
# ===========================================
# Generate a strong secret: openssl rand -base64 64
JWT_SECRET_KEY=your-super-secret-jwt-key-change-this-in-production
JWT_ALGORITHM=HS256
JWT_ISSUER=yral_auth

# ===========================================
# Google Gemini API
# ===========================================
GEMINI_API_KEY=your-gemini-api-key-here
GEMINI_MODEL=gemini-2.5-flash
GEMINI_MAX_TOKENS=2048
GEMINI_TEMPERATURE=0.7

# ===========================================
# Media Storage
# ===========================================
MAX_IMAGE_SIZE_MB=10
MAX_AUDIO_SIZE_MB=20
MAX_AUDIO_DURATION_SECONDS=300

# ===========================================
# S3 Media Upload (Required)
# Using Hetzner Object Storage (S3-compatible)
# ===========================================
AWS_ACCESS_KEY_ID=your-access-key-id
AWS_SECRET_ACCESS_KEY=your-secret-access-key
AWS_S3_BUCKET=yral-ai-chat-uploads
AWS_REGION=fsn1
# S3-compatible endpoint URL (for Hetzner Object Storage)
# IMPORTANT: Endpoint region must match AWS_REGION above
S3_ENDPOINT_URL=https://yral-ai-creator-chat-upload-artifact.fsn1.your-objectstorage.com
# Public URL base for accessing uploaded files
# Format: https://{bucket}.{region}.your-objectstorage.com
S3_PUBLIC_URL_BASE=https://yral-ai-chat-uploads.fsn1.your-objectstorage.com

# Expiration (in seconds) for generated S3 presigned URLs
# Typical values: 300 (5 minutes), 900 (15 minutes)
S3_URL_EXPIRES_SECONDS=900

# ===========================================
# Whisper API (Optional - for audio transcription)
# ===========================================
USE_WHISPER=false
WHISPER_API_KEY=

# ===========================================
# CORS Configuration
# ===========================================
CORS_ORIGINS=https://chat.yral.com,https://www.chat.yral.com
CORS_ALLOW_CREDENTIALS=true

# ===========================================
# Rate Limiting
# ===========================================
# Updated defaults for high traffic: 6000/min = 100/sec, 100000/hour
# With true async implementation, can handle 100+ req/sec
# Adjust based on:
# - Database connection pool size (default: 10, max: 20) - increased for high traffic
# - SQLite concurrency limits (WAL mode handles concurrent reads well)
# - Gemini API rate limits and costs (check your Google Cloud quota)
# - Available memory for rate limiter buckets
# - Your infrastructure capacity (CPU, memory, network)
# Maximum safe values: 10000/min, 100000/hour
# 
# For 100 req/sec peak traffic, use:
RATE_LIMIT_PER_MINUTE=6000
RATE_LIMIT_PER_HOUR=100000
#
# For lower traffic or testing, you can reduce:
# RATE_LIMIT_PER_MINUTE=300
# RATE_LIMIT_PER_HOUR=5000

# ===========================================
# Logging
# ===========================================
LOG_LEVEL=INFO
LOG_FORMAT=json

# ===========================================
# Litestream Configuration
# S3-compatible storage for SQLite replication
# ===========================================
LITESTREAM_ACCESS_KEY_ID=your-litestream-access-key-id
LITESTREAM_SECRET_ACCESS_KEY=your-litestream-secret-access-key
LITESTREAM_BUCKET=postgres-1-backup
LITESTREAM_ENDPOINT=https://postgres-1-backup.hel1.your-objectstorage.com
LITESTREAM_REGION=hel1

